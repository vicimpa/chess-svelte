var Ye=Object.defineProperty;var ze=(e,t,n)=>t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var M=(e,t,n)=>(ze(e,typeof t!="symbol"?t+"":t,n),n),we=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var re=(e,t,n)=>(we(e,t,"read from private field"),n?n.call(e):t.get(e)),ke=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Pe=(e,t,n,s)=>(we(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();function te(){}function He(e){return e()}function Oe(){return Object.create(null)}function W(e){e.forEach(He)}function _e(e){return typeof e=="function"}function Je(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ue(e){return Object.keys(e).length===0}function h(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode&&e.parentNode.removeChild(e)}function fe(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function T(e){return document.createElement(e)}function N(e){return document.createTextNode(e)}function L(){return N(" ")}function he(){return N("")}function ne(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function v(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ze(e){return Array.from(e.childNodes)}function C(e,t){t=""+t,e.data!==t&&(e.data=t)}let me;function x(e){me=e}const D=[],Ne=[];let Q=[];const Ee=[],$e=Promise.resolve();let ce=!1;function xe(){ce||(ce=!0,$e.then(qe))}function ae(e){Q.push(e)}const ue=new Set;let q=0;function qe(){if(q!==0)return;const e=me;do{try{for(;q<D.length;){const t=D[q];q++,x(t),et(t.$$)}}catch(t){throw D.length=0,q=0,t}for(x(null),D.length=0,q=0;Ne.length;)Ne.pop()();for(let t=0;t<Q.length;t+=1){const n=Q[t];ue.has(n)||(ue.add(n),n())}Q.length=0}while(D.length);for(;Ee.length;)Ee.pop()();ce=!1,ue.clear(),x(e)}function et(e){if(e.fragment!==null){e.update(),W(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ae)}}function tt(e){const t=[],n=[];Q.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),Q=t}const le=new Set;let K;function nt(){K={r:0,c:[],p:K}}function st(){K.r||W(K.c),K=K.p}function ee(e,t){e&&e.i&&(le.delete(e),e.i(t))}function de(e,t,n,s){if(e&&e.o){if(le.has(e))return;le.add(e),K.c.push(()=>{le.delete(e),s&&(n&&e.d(1),s())}),e.o(t)}else s&&s()}function lt(e){e&&e.c()}function De(e,t,n,s){const{fragment:l,after_update:r}=e.$$;l&&l.m(t,n),s||ae(()=>{const o=e.$$.on_mount.map(He).filter(_e);e.$$.on_destroy?e.$$.on_destroy.push(...o):W(o),e.$$.on_mount=[]}),r.forEach(ae)}function Qe(e,t){const n=e.$$;n.fragment!==null&&(tt(n.after_update),W(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function it(e,t){e.$$.dirty[0]===-1&&(D.push(e),xe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Re(e,t,n,s,l,r,o,u=[-1]){const a=me;x(e);const i=e.$$={fragment:null,ctx:[],props:r,update:te,not_equal:l,bound:Oe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:Oe(),dirty:u,skip_bound:!1,root:t.target||a.$$.root};o&&o(i.root);let c=!1;if(i.ctx=n?n(e,t.props||{},(_,g,...j)=>{const O=j.length?j[0]:g;return i.ctx&&l(i.ctx[_],i.ctx[_]=O)&&(!i.skip_bound&&i.bound[_]&&i.bound[_](O),c&&it(e,_)),g}):[],i.update(),c=!0,W(i.before_update),i.fragment=s?s(i.ctx):!1,t.target){if(t.hydrate){const _=Ze(t.target);i.fragment&&i.fragment.l(_),_.forEach(w)}else i.fragment&&i.fragment.c();t.intro&&ee(e.$$.fragment),De(e,t.target,t.anchor,t.customElement),qe()}x(a)}class We{$destroy(){Qe(this,1),this.$destroy=te}$on(t,n){if(!_e(n))return te;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const l=s.indexOf(n);l!==-1&&s.splice(l,1)}}$set(t){this.$$set&&!Ue(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Te(e,t){return String.fromCharCode(e.charCodeAt(0)+t)}const pe=e=>[Te("A",e%8),Te("1",e/8|0)];function je(e){let t,n;return{c(){t=T("span"),n=N(e[1]),v(t,"class","top svelte-1uf3sfs")},m(s,l){k(s,t,l),h(t,n)},p(s,l){l&2&&C(n,s[1])},d(s){s&&w(t)}}}function Se(e){let t,n;return{c(){t=T("span"),n=N(e[1]),v(t,"class","bottom svelte-1uf3sfs")},m(s,l){k(s,t,l),h(t,n)},p(s,l){l&2&&C(n,s[1])},d(s){s&&w(t)}}}function Ae(e){let t,n;return{c(){t=T("span"),n=N(e[0]),v(t,"class","left svelte-1uf3sfs")},m(s,l){k(s,t,l),h(t,n)},p(s,l){l&1&&C(n,s[0])},d(s){s&&w(t)}}}function Le(e){let t,n;return{c(){t=T("span"),n=N(e[0]),v(t,"class","right svelte-1uf3sfs")},m(s,l){k(s,t,l),h(t,n)},p(s,l){l&1&&C(n,s[0])},d(s){s&&w(t)}}}function ot(e){let t,n,s,l,r=e[2]>=0&&e[2]<=7&&je(e),o=e[2]>=56&&e[2]<=63&&Se(e),u=e[2]%8===0&&Ae(e),a=e[2]%8===7&&Le(e);return{c(){r&&r.c(),t=L(),o&&o.c(),n=L(),u&&u.c(),s=L(),a&&a.c(),l=he()},m(i,c){r&&r.m(i,c),k(i,t,c),o&&o.m(i,c),k(i,n,c),u&&u.m(i,c),k(i,s,c),a&&a.m(i,c),k(i,l,c)},p(i,[c]){i[2]>=0&&i[2]<=7?r?r.p(i,c):(r=je(i),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),i[2]>=56&&i[2]<=63?o?o.p(i,c):(o=Se(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null),i[2]%8===0?u?u.p(i,c):(u=Ae(i),u.c(),u.m(s.parentNode,s)):u&&(u.d(1),u=null),i[2]%8===7?a?a.p(i,c):(a=Le(i),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},i:te,o:te,d(i){r&&r.d(i),i&&w(t),o&&o.d(i),i&&w(n),u&&u.d(i),i&&w(s),a&&a.d(i),i&&w(l)}}}function rt(e,t,n){let s,l,r,o,{index:u=-1}=t,{position:a=u}=t;return e.$$set=i=>{"index"in i&&n(3,u=i.index),"position"in i&&n(4,a=i.position)},e.$$.update=()=>{e.$$.dirty&8&&n(5,s=+u),e.$$.dirty&16&&n(2,l=+a),e.$$.dirty&32&&n(1,[r,o]=pe(s),r,(n(0,o),n(5,s),n(3,u)))},[o,r,l,u,a,s]}class ft extends We{constructor(t){super(),Re(this,t,rt,ot,Je,{index:3,position:4})}}var R;class X{constructor(t,n){ke(this,R,void 0);M(this,"player");M(this,"chars","  ");this.player=t,Pe(this,R,n)}get map(){return re(this,R)}get position(){var t;return((t=re(this,R))==null?void 0:t.indexOf(this))??-1}get char(){return this.chars[this.player]??""}positions(){const{map:t}=this;return t.indexOf(this)<0?[]:[]}calcPositions(t,n=t,s=1){const l=[];if(this.position===-1){for(let u=0;u<8;u++)for(let a=0;a<8;a++){const i=this.vecToPos(u,a);this.map[i]||l.push(i)}return l}const[r,o]=this.posToVec();for(const u of new Set([...t,...n])){const[a,i]=u,c=n.includes(u),_=t.includes(u);for(let g=1;g<=s;g++){const j=r+a*g,O=o+i*g,b=this.vecToPos(j,O),p=this.map[b];if(j<0||j>7||O<0||O>7)break;if(p){p.isOtherPlayer(this)&&c&&l.push(b);break}else _&&l.push(b)}}return l}posToVec(t=this.position){const{map:n,player:s}=this,l=n.posToVec(t);return s||(l[1]=7-l[1]),l}vecToPos(t,n){const{map:s,player:l}=this;return l||(n=7-n),s.vecToPos(t,n)}isOtherPlayer(t){return(t==null?void 0:t.player)===+!this.player}}R=new WeakMap;class ut extends X{constructor(){super(...arguments);M(this,"chars","♗♝")}positions(){return this.calcPositions([[-1,-1],[-1,1],[1,-1],[1,1]],void 0,8)}}class ct extends X{constructor(){super(...arguments);M(this,"chars","♔♚")}positions(){return this.calcPositions([[-1,-1],[-1,1],[1,-1],[1,1],[0,-1],[0,1],[-1,0],[1,0]])}}class at extends X{constructor(){super(...arguments);M(this,"chars","♘♞")}positions(){return this.calcPositions([[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1],[-2,-1],[-2,1]])}}class dt extends X{constructor(){super(...arguments);M(this,"chars","♙♟")}positions(){const n=[[0,1]];return this.posToVec()[1]===1&&n.push([0,2]),this.calcPositions(n,[[-1,1],[1,1]])}}class pt extends X{constructor(){super(...arguments);M(this,"chars","♕♛")}positions(){return this.calcPositions([[-1,-1],[-1,1],[1,-1],[1,1],[0,-1],[0,1],[-1,0],[1,0]],void 0,8)}}class _t extends X{constructor(){super(...arguments);M(this,"chars","♖♜")}positions(){return this.calcPositions([[0,-1],[0,1],[-1,0],[1,0]],void 0,8)}}class ht extends Array{constructor(){super(64)}posToVec(t){return[t%8|0,t/8|0]}vecToPos(t,n){return n*8+t}appendFigures(){this.fill(null);for(let t=0;t<2;t++){for(let n=0;n<8;n++)this[8+t*40+n]=new dt(1-t,this);for(let n=0;n<2;n++)this[t*56+n*7]=new _t(1-t,this);for(let n=0;n<2;n++)this[t*56+n*5+1]=new at(1-t,this);for(let n=0;n<2;n++)this[t*56+n*3+2]=new ut(1-t,this);for(let n=0;n<2;n++)this[t*56+n+3]=new[pt,ct][n](1-t,this)}}}function Ce(e,t,n){const s=e.slice();return s[13]=t[n],s}function Fe(e,t,n){const s=e.slice();return s[16]=t[n][0],s[13]=t[n][1],s[18]=n,s}function Me(e,t,n){const s=e.slice();return s[13]=t[n],s}function Ve(e){var i;let t,n=(((i=e[13])==null?void 0:i.char)??"")+"",s,l,r,o,u;function a(...c){return e[10](e[13],...c)}return{c(){t=T("div"),s=N(n),l=L(),v(t,"class","item"),v(t,"data-select",r=e[13]&&e[13]===e[0])},m(c,_){k(c,t,_),h(t,s),h(t,l),o||(u=ne(t,"mousedown",a),o=!0)},p(c,_){var g;e=c,_&4&&n!==(n=(((g=e[13])==null?void 0:g.char)??"")+"")&&C(s,n),_&5&&r!==(r=e[13]&&e[13]===e[0])&&v(t,"data-select",r)},d(c){c&&w(t),o=!1,u()}}}function Be(e){var s;let t,n=e[13]&&!!((s=e[13])!=null&&s.player)===e[3]&&Ve(e);return{c(){n&&n.c(),t=he()},m(l,r){n&&n.m(l,r),k(l,t,r)},p(l,r){var o;l[13]&&!!((o=l[13])!=null&&o.player)===l[3]?n?n.p(l,r):(n=Ve(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(l){n&&n.d(l),l&&w(t)}}}function Ie(e){var O;let t,n,s,l=(((O=e[13])==null?void 0:O.char)??"")+"",r,o,u,a,i,c,_,g,j;return n=new ft({props:{index:e[16],position:e[18]}}),{c(){var b,p;t=T("div"),lt(n.$$.fragment),s=L(),r=N(l),o=L(),v(t,"class","item"),v(t,"data-pos",u=e[16]+e[16]/8&1),v(t,"data-select",a=e[13]&&e[13]===e[0]),v(t,"data-can-move",i=(b=e[4])==null?void 0:b.includes(e[16])),v(t,"data-negative",c=((p=e[13])==null?void 0:p.player)===0)},m(b,p){k(b,t,p),De(n,t,null),h(t,s),h(t,r),h(t,o),_=!0,g||(j=ne(t,"mousedown",function(){_e(e[7](e[16]))&&e[7](e[16]).apply(this,arguments)}),g=!0)},p(b,p){var G,Y,z;e=b;const P={};p&42&&(P.index=e[16]),n.$set(P),(!_||p&42)&&l!==(l=(((G=e[13])==null?void 0:G.char)??"")+"")&&C(r,l),(!_||p&42&&u!==(u=e[16]+e[16]/8&1))&&v(t,"data-pos",u),(!_||p&43&&a!==(a=e[13]&&e[13]===e[0]))&&v(t,"data-select",a),(!_||p&58&&i!==(i=(Y=e[4])==null?void 0:Y.includes(e[16])))&&v(t,"data-can-move",i),(!_||p&42&&c!==(c=((z=e[13])==null?void 0:z.player)===0))&&v(t,"data-negative",c)},i(b){_||(ee(n.$$.fragment,b),_=!0)},o(b){de(n.$$.fragment,b),_=!1},d(b){b&&w(t),Qe(n),g=!1,j()}}}function Ke(e){var i;let t,n=(((i=e[13])==null?void 0:i.char)??"")+"",s,l,r,o,u;function a(...c){return e[11](e[13],...c)}return{c(){t=T("div"),s=N(n),l=L(),v(t,"class","item"),v(t,"data-select",r=e[13]&&e[13]===e[0])},m(c,_){k(c,t,_),h(t,s),h(t,l),o||(u=ne(t,"mousedown",a),o=!0)},p(c,_){var g;e=c,_&4&&n!==(n=(((g=e[13])==null?void 0:g.char)??"")+"")&&C(s,n),_&5&&r!==(r=e[13]&&e[13]===e[0])&&v(t,"data-select",r)},d(c){c&&w(t),o=!1,u()}}}function Ge(e){var s;let t,n=e[13]&&!((s=e[13])!=null&&s.player)===e[3]&&Ke(e);return{c(){n&&n.c(),t=he()},m(l,r){n&&n.m(l,r),k(l,t,r)},p(l,r){var o;l[13]&&!((o=l[13])!=null&&o.player)===l[3]?n?n.p(l,r):(n=Ke(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(l){n&&n.d(l),l&&w(t)}}}function mt(e){var ye;let t,n,s=(((ye=e[0])==null?void 0:ye.position)??-1)+"",l,r,o=(e[0]?pe(e[0].position).join(" "):"null")+"",u,a,i=JSON.stringify(e[0])+"",c,_,g,j,O,b,p,P=e[3]?"↑":"↓",G,Y,z,se,ie,F,U,be,Z,ge,$,V,oe,ve,H=[...e[2]],S=[];for(let f=0;f<H.length;f+=1)S[f]=Be(Me(e,H,f));let I=e[3]?e[5]:e[1],y=[];for(let f=0;f<I.length;f+=1)y[f]=Ie(Fe(e,I,f));const Xe=f=>de(y[f],1,1,()=>{y[f]=null});let J=[...e[2]],A=[];for(let f=0;f<J.length;f+=1)A[f]=Ge(Ce(e,J,f));return{c(){t=T("p"),n=N("Select: "),l=N(s),r=N(" ( "),u=N(o),a=N(" ) "),c=N(i),_=L(),g=T("p"),g.innerHTML=`<b>ЛКМ</b> - Выбор и перемещение (по правилам) <br/> 
  <b>СКМ</b> - Перемещение выбранной фигуры в любую клетку <br/> 
  <b>ПКМ</b> - Удаление фигуры <br/>  <br/>
  Исходный код искать на
  <a href="https://github.com/vicimpa/chess-svelte">GitHub</a>`,j=L(),O=T("p"),b=T("button"),p=N("Перевернуть ("),G=N(P),Y=N(")"),z=L(),se=T("button"),se.textContent="Сбросить",ie=L(),F=T("div"),U=T("div");for(let f=0;f<S.length;f+=1)S[f].c();be=L(),Z=T("div");for(let f=0;f<y.length;f+=1)y[f].c();ge=L(),$=T("div");for(let f=0;f<A.length;f+=1)A[f].c();v(U,"class","list"),v(Z,"class","map svelte-l5s9fd"),v($,"class","list"),v(F,"class","content")},m(f,m){k(f,t,m),h(t,n),h(t,l),h(t,r),h(t,u),h(t,a),h(t,c),k(f,_,m),k(f,g,m),k(f,j,m),k(f,O,m),h(O,b),h(b,p),h(b,G),h(b,Y),h(O,z),h(O,se),k(f,ie,m),k(f,F,m),h(F,U);for(let E=0;E<S.length;E+=1)S[E]&&S[E].m(U,null);h(F,be),h(F,Z);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(Z,null);h(F,ge),h(F,$);for(let E=0;E<A.length;E+=1)A[E]&&A[E].m($,null);V=!0,oe||(ve=[ne(b,"click",e[9]),ne(se,"click",e[6])],oe=!0)},p(f,[m]){var E;if((!V||m&1)&&s!==(s=(((E=f[0])==null?void 0:E.position)??-1)+"")&&C(l,s),(!V||m&1)&&o!==(o=(f[0]?pe(f[0].position).join(" "):"null")+"")&&C(u,o),(!V||m&1)&&i!==(i=JSON.stringify(f[0])+"")&&C(c,i),(!V||m&8)&&P!==(P=f[3]?"↑":"↓")&&C(G,P),m&13){H=[...f[2]];let d;for(d=0;d<H.length;d+=1){const B=Me(f,H,d);S[d]?S[d].p(B,m):(S[d]=Be(B),S[d].c(),S[d].m(U,null))}for(;d<S.length;d+=1)S[d].d(1);S.length=H.length}if(m&187){I=f[3]?f[5]:f[1];let d;for(d=0;d<I.length;d+=1){const B=Fe(f,I,d);y[d]?(y[d].p(B,m),ee(y[d],1)):(y[d]=Ie(B),y[d].c(),ee(y[d],1),y[d].m(Z,null))}for(nt(),d=I.length;d<y.length;d+=1)Xe(d);st()}if(m&13){J=[...f[2]];let d;for(d=0;d<J.length;d+=1){const B=Ce(f,J,d);A[d]?A[d].p(B,m):(A[d]=Ge(B),A[d].c(),A[d].m($,null))}for(;d<A.length;d+=1)A[d].d(1);A.length=J.length}},i(f){if(!V){for(let m=0;m<I.length;m+=1)ee(y[m]);V=!0}},o(f){y=y.filter(Boolean);for(let m=0;m<y.length;m+=1)de(y[m]);V=!1},d(f){f&&w(t),f&&w(_),f&&w(g),f&&w(j),f&&w(O),f&&w(ie),f&&w(F),fe(S,f),fe(y,f),fe(A,f),oe=!1,W(ve)}}}function bt(e,t,n){let s,l,r,o=new ht,u=new Set,a=!1;o.appendFigures();let i=null;function c(p,P){p&&u.delete(p),p&&p.position!==-1&&n(8,o[p.position]=null,o),o[P]&&u.add(o[P]),n(8,o[P]=i,o),n(2,u),n(0,i=null)}function _(){o.fill(null),o.appendFigures(),u.clear(),n(8,o),n(2,u)}function g(p){return P=>{switch(P.button){case 0:{if(i&&(s!=null&&s.includes(p))){c(i,p);return}if(!o[p]||i===o[p]){n(0,i=null);return}n(0,i=o[p]);return}case 1:{i&&c(i,p);return}case 2:{if(i){n(0,i=null);return}c(null,p);return}}}}const j=p=>n(3,a=!a),O=(p,{button:P})=>!P&&n(0,i=p),b=(p,{button:P})=>!P&&n(0,i=p);return e.$$.update=()=>{e.$$.dirty&1&&n(4,s=i==null?void 0:i.positions()),e.$$.dirty&256&&n(1,l=Object.entries(o).map(([p,P])=>[+p,P])),e.$$.dirty&2&&n(5,r=[...l].reverse())},[i,l,u,a,s,r,_,g,o,j,O,b]}class gt extends We{constructor(t){super(),Re(this,t,bt,mt,Je,{})}}new gt({target:document.getElementById("app")});addEventListener("contextmenu",e=>e.preventDefault());
